package example

import (
	"github.com/tiket/TIX-HOTEL-UTILITIES-GO/logs"
	kafka2 "github.com/tiket/TIX-HOTEL-UTILITIES-GO/messaging/kafka"
)

func kafkaPublish() {
	//topic := "com.tiket.tix.hotel.search-syncHotel"
	//var message = `{"id":"5cb051db0bae481c876115ae","hotelId":"9bc92df0-e135-4c2f-a5e0-48e903256d28","publicId":"fadhil-guest-house-204001555059163073","tripAdvisorId":null,"name":"Fadhil Guest House","alternativeName":{"id":"No"},"aliasName":[],"address":"Jl. Orangutan, Bukit Lawang, Bohorok, Kabupaten Langkat, Sumatera Utara, Indonesia","starRating":1.0,"geoLocation":{"lat":3.5502525,"lon":98.1231282},"country":{"id":"indonesia","name":{"en":"Indonesia","cn":"印度尼西亚","id":"Indonesia"}},"region":{"id":"north-sumatera-108001534490276409","name":{"en":"North Sumatera","alias":"Sumatera Utara","id":"Sumatera Utara"}},"city":{"id":"langkat-108001534490334517","name":{"en":"Langkat","alias":"Langkat","id":"Langkat"}},"areas": [{"id": "padang-tualang-108001534490334519","name": {"en":"Padang Tualang","alias": "Padang Tualang","id": "Padang Tualang"}},{"id": "robin-123","name": {"en": "Robin","alias":"Robin","id": "Robin"}}],"postalCode":"20774","checkInTime":"14:00-14:00","checkOutTime":"12:00","description":{"en":"Fadhil Guest House features a garden. Each accommodation at the 3-star guest house has mountain views and free WiFi. Guests can make use of a terrace. The rooms in the guest house are fitted with a kettle. The rooms are equipped with a private bathroom with free toiletries. The units feature a seating area.","id":""},"hotelPolicy":{},"phoneNumber":[],"airportCode":null,"timeZone":"+07:00","mainImageUrl":null,"mobileMainImageUrl":null,"propertyType":null,"hotelChain":{"id":"independent-108001534479551638","name":"Independent"},"hotelBrand":null,"facilities":[{"groupId":"SPORTS_AND_RECREATIONS","groupName":{"en":"Sports and Recreations","id":"Olahraga,Spa dan Rekreasi"},"groupIconUrl":"https://static.tiket.photos/image/upload/v1539682565/hotel/statis/facility/2018/10/16/d9dde60f-67a1-4554-aa50-cd9ad8133c908274b6afb96f3f5a4b0daa0e101bb659.png","listFacility":[{"id":"GARDEN","name":{"en":"Garden","id":"Taman"}},{"id":"HIKING","name":{"en":"Hiking","id":"Hiking"}}]},{"groupId":"PETS","groupName":{"en":"Pets","id":"Hewan Peliharaan"},"groupIconUrl":"https://static.tiket.photos/image/upload/v1539682356/hotel/statis/facility/2018/10/16/444a692d-85de-49ba-80cb-9940bde5426404d6fe37459745e7e2fc86c7bafbcad7.png","listFacility":[{"id":"PETS_ALLOWED","name":{"en":"Pets allowed","id":"Hewan peliharaan dibolehkan"}}]},{"groupId":"HOTEL_SERVICES","groupName":{"en":"Hotel Services","id":"Layanan Hotel"},"groupIconUrl":"https://static.tiket.photos/image/upload/v1539681951/hotel/statis/facility/2018/10/16/53f60d12-2484-4309-b84b-103bf03e3b30d384affe78674aa92823550631b72128.png","listFacility":[{"id":"MULTILINGUAL_STAFF","name":{"en":"Multilingual staff","id":"Staf multibahasa"}}]},{"groupId":"OTHER_FACILITIES","groupName":{"en":"Other Facilities","id":"Fasilitas Lainnya"},"groupIconUrl":"https://static.tiket.photos/image/upload/v1539682107/hotel/statis/facility/2018/10/16/a15a1c5d-184b-44fd-b06f-56039638f0150ee8cab50a626b7647ec1efee8cf748d.png","listFacility":[{"id":"CHECKINOUT_PRIVATE","name":{"en":"Check-in/out [private]","id":"Check-in / out [pribadi]"}},{"id":"FREE_SELF_PARKING","name":{"en":"Free self parking","id":"Parkir mandiri gratis"}},{"id":"CURRENCY_EXCHANGE_FACILITIES","name":{"en":"Currency exchange facilities","id":"Fasilitas penukaran mata uang"}},{"id":"CAR_HIRE","name":{"en":"Car hire","id":"Penyewaan mobil"}}]},{"groupId":"FOOD_DRINKS","groupName":{"en":"Food & Drinks","id":"Makanan dan Minuman"},"groupIconUrl":"https://static.tiket.photos/image/upload/v1539681766/hotel/statis/facility/2018/10/16/20e7cf9b-5c4c-4375-9e0e-47ff31e8117533ad794a0fbc95c461f9ace0d1f379db.png","listFacility":[{"id":"COFFEE_SHOP_OR_CAF","name":{"en":"Coffee shop or cafÌ©","id":"Kafe atau kedai kopi"}},{"id":"RESTAURANT","name":{"en":"Restaurant","id":"Restoran"}}]},{"groupId":"TRANSPORTATION","groupName":{"en":"Transportation","id":"Transportasi"},"groupIconUrl":"https://static.tiket.photos/image/upload/v1539682670/hotel/statis/facility/2018/10/16/5677458e-3944-4e89-a93c-8f14b450c565a58a6027a9ae11f407154524c1c3bee8.png","listFacility":[{"id":"AIRPORT_TRANSFER_ADDITIONAL_CHARGE","name":{"en":"Airport Transfer (additional charge)","id":"Antar /Jemput Bandara (biaya tambahan)"}},{"id":"FREE_AREA_SHUTTLE","name":{"en":"Free area shuttle","id":"Antar-jemput gratis ke kawasan sekitar"}}]},{"groupId":"CONNECTIVITY","groupName":{"en":"Connectivity","id":"Konektivitas"},"groupIconUrl":"https://static.tiket.photos/image/upload/v1539681686/hotel/statis/facility/2018/10/16/6232b0ac-5ecf-449d-8beb-889cb25f68d1642a628e9a5209094d0e5538a146cc99.png","listFacility":[{"id":"FREE_WIFI_LIMITED_DURATION","name":{"en":"Free WiFi (limited) duration","id":"WiFi Gratis durasi (terbatas)"}}]}],"facilityTags":[{"id":"PARKING","name":{"en":"Parking","id":"Tempat Parkir"},"iconUrl":"https://static.tiket.photos/image/upload/v1539682180/hotel/statis/facility/2018/10/16/1c300187-df04-465e-bd39-f27eacf414429656405953c88debf54970ec81c007d3.png"},{"id":"RESTAURANT","name":{"en":"Restaurant","id":"Restoran"},"iconUrl":"https://static.tiket.photos/image/upload/v1539681766/hotel/statis/facility/2018/10/16/20e7cf9b-5c4c-4375-9e0e-47ff31e8117533ad794a0fbc95c461f9ace0d1f379db.png"},{"id":"WIFI","name":{"en":"WiFi","id":"WiFi"},"iconUrl":"https://static.tiket.photos/image/upload/v1539681686/hotel/statis/facility/2018/10/16/6232b0ac-5ecf-449d-8beb-889cb25f68d1642a628e9a5209094d0e5538a146cc99.png"}],"paymentOptions":null,"images":[],"vendors":[{"name":"AGODA","vendorExternalId":"6864988","paymentOptions":null,"isActive":1},{"name":"TIKET","vendorExternalId":"31215881","paymentOptions":null,"isActive":1}],"weightValue":0.0,"isActive":1,"isDeleted":0,"reviewSummary":null}`
	topic := "com.tiket.tix.hotel.core-vendorDownSchedule"
	var message = `{"vendor": "EXPEDIA","startDateTime": "1567610520000","endDateTime": "1575558900000","isActive": 1,"storeId": "TIKETCOM"}`

	option := kafka2.Option{
		Host:          []string{"localhost:9092"},
		ConsumerGroup: "asd",
		Interval:      1,
	}
	log, _ := logs.DefaultLog()
	kafka, err := kafka2.New(option, log)
	if err != nil {
		panic(err)
	}

	_ = kafka.Publish(topic, message)
}
